Development notes
================
Check the notes below in order to start development

# Prerequisites

* [Jekyll](https://jekyllrb.com/docs/installation/)
* [Node](https://nodejs.org/en/download/package-manager/)
* [npm-run](https://www.npmjs.com/package/npm-run) - `npm install -g npm-run` - it's used within NPM scripts
to be sure that local versions of node utilities are used.
* [firebase CLI](https://github.com/firebase/firebase-tools) - 
`npm install -g firebase-tools` in order to run firebase from terminal.
* [functions](https://github.com/GoogleCloudPlatform/cloud-functions-emulator) - 
`npm install -g @google-cloud/functions-emulator` in order to run functions emulator from terminal.

In order to install all NPM global utilities run following command from the repository root folder:

```bash
bin/npm-install.sh
```

## Git configuration

We are using GitFlow in this project, so in order to setup correct git-flow templates run following command
from the repository root folder:

```bash
bin/gitconfig.sh
```

## Install ImageMagick

ImageMagick is used with `jekyll-responsive-image` plugin and should be manually installed before
plugin gem could be installed.

### Windows

Download ImageMagic 6 (for needed OS architecture) from [here][image_magick_download]. 
Tested with [this one][image_magick_6_x64] for Win10x64.

Install to some location without spaces, e.g.: `c:\tools\imagemagic`.
During installation check  be sure to check following checkboxes:
* Install development headers and libraries for C and C++
* Install ImageMagicObject OLE Control for VBscript, Visual Basic, and WSH

Then install `rmagic` gem with following command, assuming you've installed image magic into `c\tools\imagemagic`:

```
gem install rmagick -- --with-opt-dir=c:\tools\imagemagic
```

[image_magick_download]: https://www.imagemagick.org/download/binaries/
[image_magick_6_x64]: https://www.imagemagick.org/download/binaries/ImageMagick-6.9.8-3-Q16-x64-dll.exe

### Ubuntu

Run the following commands:
```bash
sudo apt-get install libmagickwand-dev
sudo gem install rmagick
```

# How to build

Use `npm` scripts in order to build whole website into the `public` directory within repository root folder:

```bash
npm run build
```

# How to run DEV server

Use `npm` scripts in order to provide real-time updates of both Angular app
and Jekyll generated content.

In order to run webpack watcher run:

```
npm run webpack:watch
```

In order to run Jekyll web server run:

```
npm run start
```

## What is used in the background?

Webpack uses Bible in order to transpile ES6 JS cone into ES5-compatible one.

Webpack's watchers are used to provide real-time updates of the resulting transpiled 
code base to Jekyll.

Jekyll generates and serves static content.

Firebase uploads generated by Jekyll content to its hosting.

# How to deploy

1. Configure/create Firebase account in [firebase console](https://console.firebase.google.com)
2. Login into account using `firebase login`
4. Run `npm run deploy -- --project <YOUR_FIREBASE_PROJECT_ID>` in order to re-build everything and deploy your app